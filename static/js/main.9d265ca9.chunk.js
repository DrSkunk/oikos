(this.webpackJsonpoikos=this.webpackJsonpoikos||[]).push([[0],{37:function(e,t,a){e.exports=a(54)},42:function(e,t,a){},54:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(26),l=a.n(o),i=(a(42),a(9)),c=a(10),s=a(11),u=a(12),d=a(27),m=a.n(d),f=a(33),v=a(8),p=a(34),h=a(35),b=a(20),g=a(36),y=a(6),k=a(7),E=a(13),j=a.n(E),w=(a(43),a(45),{apiKey:"AIzaSyA2Gllzx6Nrq32n3WdEBiWdTP0jG0a4swk",authDomain:"oikos-game.firebaseapp.com",databaseURL:"https://oikos-game.firebaseio.com",projectId:"oikos-game",storageBucket:"oikos-game.appspot.com",messagingSenderId:"996454215912"}),O=new(function(){function e(){Object(i.a)(this,e),j.a.initializeApp(w),this.auth=j.a.auth(),this.db=j.a.database(),this.serverTime=j.a.database.ServerValue.TIMESTAMP}return Object(c.a)(e,[{key:"gameId",set:function(e){this.ref=this.db.ref("games").child(e)}}]),e}()),x=[{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0}];function C(){O.ref.set({board:x}).catch((function(e){return console.error(e)}))}function I(e,t){return O.ref.update({lastUpdated:O.serverTime}),O.ref.child("board").child(e).update(t)}function T(){C()}var S=a(28),M=a.n(S),z="moveWorker",R="addLevel",A="removeLevel",W="addWorker",G="removeWorker",L="addRoof",B="removeRoof";function N(e,t,a,n){var r=e.mode,o=e.selectedTile,l=e.team,i=a.board,c=M()(e);switch(console.log("newState",c),r){case z:if(null===o)return;console.log("player",o,a,i[o]),I(t,{player:i[o].player}),I(o,{player:0});break;case R:I(t,{level:Math.min(n.level+1,3)});break;case A:I(t,{level:Math.max(n.level-1,0)});break;case W:I(t,{player:l});break;case G:I(t,{player:0});break;case L:I(t,{roof:!0});break;case B:I(t,{roof:!1})}}function P(){var e=Object(y.a)(["\n  fill: ",";\n  stroke: #000000;\n  stroke-width: 2.5px;\n"]);return P=function(){return e},e}function U(){var e=Object(y.a)(["\n  z-index: 4;\n"]);return U=function(){return e},e}function D(){var e=Object(y.a)(["\n  z-index: 3;\n"]);return D=function(){return e},e}function J(){var e=Object(y.a)(["\n  z-index: 2;\n"]);return J=function(){return e},e}function q(){var e=Object(y.a)(["\n  z-index: 1;\n"]);return q=function(){return e},e}function K(){var e=Object(y.a)(["\n  position: absolute;\n  left: 0;\n  top: 0%;\n"]);return K=function(){return e},e}function V(){var e=Object(y.a)(["\n  /* display: flex;\n  justify-content: center;\n  align-items: center;\n  text-align: center; */\n  width: 100px;\n  height: 100px;\n  background-color: #ddd;\n  border: 1px solid transparent;\n  position: relative;\n  ","\n\n  cursor: pointer;\n  &:hover {\n    border: 1px solid black;\n  }\n"]);return V=function(){return e},e}var $=k.a.div(V(),(function(e){return e.selected?"outline: 5px solid yellow;":""})),F=k.a.img(K()),H=Object(k.a)(F)(q()),Q=Object(k.a)(F)(J()),X=Object(k.a)(F)(D()),Y=Object(k.a)(F)(U()),Z=k.a.circle(P(),(function(e){return _[e.player]})),_={1:"red",2:"green",3:"blue",4:"purple"},ee=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){var e=this.props,t=e.level,a=e.roof,n=e.player,o=e.selected,l=e.onClick;return r.a.createElement($,{onClick:l,selected:o},t>=1?r.a.createElement(H,{style:{zIndex:1},width:"100",height:"100",src:"/oikos/imgs/building/stage1.png",alt:"level1"}):null,t>=2?r.a.createElement(Q,{style:{zIndex:2},width:"100",height:"100",src:"/oikos/imgs/building/stage2.png",alt:"level2"}):null,t>=3?r.a.createElement(X,{style:{zIndex:3},width:"100",height:"100",src:"/oikos/imgs/building/stage3.png",alt:"level3"}):null,a?r.a.createElement(Y,{style:{zIndex:4},width:"100",height:"100",src:"/oikos/imgs/building/roof.png",alt:"roof"}):null,n?r.a.createElement("svg",{width:"100",height:"100",style:{position:"relative",zIndex:5}},r.a.createElement(Z,{cx:"50",cy:"50",r:"20",player:n})):null)}}]),a}(n.Component);function te(){var e=Object(y.a)(["\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: space-between;\n  height: 540px;\n  margin-top: 10px;\n"]);return te=function(){return e},e}var ae=k.a.div(te()),ne=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).onTileClick=function(e,t){n.setState((function(a){if(a.mode===z)return a.selectedTile===e?{selectedTile:null}:null===a.selectedTile?{selectedTile:e}:(N(a,e,n.props.game,t),{selectedTile:null});N(a,e,n.props.game,t)}))},n.setMode=function(e){e!==z?n.setState({mode:e,selectedTile:null}):n.setState({mode:e})},n.handleChange=function(e){var t=parseInt(e.target.value);n.setState({team:t})},n.state={mode:z,selectedTile:null,team:1},n}return Object(c.a)(a,[{key:"render",value:function(){var e=this,t=this.props.game,a=this.state,n=a.mode,o=a.team,l=a.selectedTile,i=Object.values(t.board).map((function(t,a){return r.a.createElement(ee,{key:"tile"+a,level:t.level,roof:t.roof,player:t.player,onClick:function(){e.onTileClick(a,t)},selected:a===l})}));return r.a.createElement("div",null,r.a.createElement("label",null,"Team",r.a.createElement("select",{value:o,onChange:this.handleChange},r.a.createElement("option",{value:"1"},"Red"),r.a.createElement("option",{value:"2"},"Green"),r.a.createElement("option",{value:"3"},"Blue"),r.a.createElement("option",{value:"4"},"Purple"))),r.a.createElement(v.a,{variant:"secondary",onClick:function(){return e.setMode(z)},disabled:n===z},"Move worker"),r.a.createElement(v.a,{variant:"secondary",onClick:function(){return e.setMode(R)},disabled:n===R},"Add level"),r.a.createElement(v.a,{variant:"secondary",onClick:function(){return e.setMode(A)},disabled:n===A},"remove level"),r.a.createElement(v.a,{variant:"secondary",onClick:function(){return e.setMode(W)},disabled:n===W},"Add Worker"),r.a.createElement(v.a,{variant:"secondary",onClick:function(){return e.setMode(G)},disabled:n===G},"Remove worker"),r.a.createElement(v.a,{variant:"secondary",onClick:function(){return e.setMode(L)},disabled:n===L},"Add roof"),r.a.createElement(v.a,{variant:"secondary",onClick:function(){return e.setMode(B)},disabled:n===B},"Remove roof"),r.a.createElement(ae,null,i),r.a.createElement(v.a,{variant:"secondary",onClick:T},"Reset board"))}}]),a}(n.Component);function re(){var e=Object(y.a)(["\n  width: 540px;\n  margin: 0 auto;\n"]);return re=function(){return e},e}var oe=k.a.div(re()),le=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(e){var n;return Object(i.a)(this,a),console.log("constructor"),n=t.call(this,e),O.gameId=n.props.room,console.log(O,n.props.room),n.state={loading:!0},n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.updateListener=O.ref.on("value",(function(t){var a=t.val();if(null===a)try{C(e.state.gameId)}catch(n){e.setState({error:!0})}else e.setState({game:a,loading:!1})}))}},{key:"render",value:function(){var e=this.state,t=e.loading,a=e.error,n=e.game,o=e.gameId;return a?r.a.createElement("div",null,"An error occured, please refresh page to try again. If this persists, contact ",r.a.createElement("a",{href:"https://sebastiaanjansen.be/contact"},"Sebastiaan"),"."):t?r.a.createElement("div",null,"Loading...."):r.a.createElement(oe,null,r.a.createElement(ne,{game:n,gameId:o}))}}]),a}(n.Component),ie=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(e){var n;Object(i.a)(this,a),(n=t.call(this,e)).state={},n.onRoomChange=function(e){console.log(e.target.value),n.setState({room:e.target.value})},n.startNewGame=function(){var e=window.location.origin+window.location.pathname+"?room="+n.state.room;window.history.replaceState(null,null,e),n.setState({lobby:!1})};var r=new URL(window.location).searchParams.get("room");return r?(r=r.replace(/[^\w\s]/gi,""),n.state.lobby=!1):(r=m()(3).join("-"),n.state.lobby=!0),n.state.room=r,n}return Object(c.a)(a,[{key:"render",value:function(){var e=this.state,t=e.room;return e.lobby?r.a.createElement(f.a,null,r.a.createElement(p.a,null,r.a.createElement(h.a,{className:"col-lg-4 offset-lg-3"},r.a.createElement("h1",{className:"header"},"Oikos"),r.a.createElement(b.a,null,r.a.createElement(g.a,{placeholder:"room code","aria-label":"room code",value:t,onChange:this.onRoomChange}),r.a.createElement(b.a.Append,null,r.a.createElement(v.a,{variant:"outline-secondary",onClick:this.startNewGame},"Go")))))):r.a.createElement(le,{room:t})}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(ie,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[37,1,2]]]);
//# sourceMappingURL=main.9d265ca9.chunk.js.map