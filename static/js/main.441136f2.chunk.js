(this.webpackJsonpoikos=this.webpackJsonpoikos||[]).push([[0],{26:function(e,t,n){e.exports=n(46)},31:function(e,t,n){},46:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),l=n(20),o=n.n(l),i=(n(31),n(4)),c=n(5),u=n(6),s=n(7),d=n(2),f=n(14),p=n.n(f),v=n(3),m=n(8),h=n.n(m),b=(n(40),n(42),{apiKey:"AIzaSyA2Gllzx6Nrq32n3WdEBiWdTP0jG0a4swk",authDomain:"oikos-game.firebaseapp.com",databaseURL:"https://oikos-game.firebaseio.com",projectId:"oikos-game",storageBucket:"oikos-game.appspot.com",messagingSenderId:"996454215912"}),g=new(function(){function e(){Object(i.a)(this,e),h.a.initializeApp(b),this.auth=h.a.auth(),this.db=h.a.database(),this.serverTime=h.a.database.ServerValue.TIMESTAMP}return Object(c.a)(e,[{key:"gameId",set:function(e){this.ref=this.db.ref("games").child(e)}}]),e}()),y=n(21),k=n.n(y),w="moveWorker",E="addLevel",j="removeLevel",O="addWorker",x="removeWorker",C="addRoof",T="removeRoof";function I(e,t){return g.ref.update({lastUpdated:g.serverTime}),g.ref.child("board").child(e).update(t)}function M(e,t,n,r){var a=e.mode,l=e.selectedTile,o=e.team,i=n.board,c=k()(e);switch(console.log("newState",c),a){case w:if(null===l)return;console.log("player",l,n,i[l]),I(t,{player:i[l].player}),I(l,{player:0});break;case E:I(t,{level:Math.min(r.level+1,3)});break;case j:I(t,{level:Math.max(r.level-1,0)});break;case O:I(t,{player:o});break;case x:I(t,{player:0});break;case C:I(t,{roof:!0});break;case T:I(t,{roof:!1})}}function S(){var e=Object(d.a)(["\n  fill: ",";\n  stroke: #000000;\n  stroke-width: 2.5px;\n"]);return S=function(){return e},e}function A(){var e=Object(d.a)(["\n  fill: blue;\n  stroke: #000000;\n  stroke-width: 2.5px;\n"]);return A=function(){return e},e}function W(){var e=Object(d.a)(["\n  fill: gray;\n  stroke: #000000;\n  stroke-width: 2.5px;\n"]);return W=function(){return e},e}function R(){var e=Object(d.a)(["\n  fill: green;\n"]);return R=function(){return e},e}function L(){var e=Object(d.a)(["\n  fill: red;\n"]);return L=function(){return e},e}function B(){var e=Object(d.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  text-align: center;\n  width: 100px;\n  height: 100px;\n  background-color: #ddd;\n  border: 1px solid transparent;\n  ","\n\n  cursor: pointer;\n  &:hover {\n    border: 1px solid black;\n  }\n"]);return B=function(){return e},e}var P=v.a.div(B(),(function(e){return e.selected?"outline: 5px solid yellow;":""})),z=v.a.rect(L()),G=v.a.rect(R()),U=v.a.polygon(W()),D=v.a.circle(A()),J=v.a.circle(S(),(function(e){return q[e.player]})),q={1:"red",2:"green",3:"blue",4:"purple"},K=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){var e=this.props,t=e.level,n=e.roof,r=e.player,l=e.selected,o=e.onClick;return a.a.createElement(P,{onClick:o,selected:l},a.a.createElement("svg",{width:"100",height:"100"},t>=1?a.a.createElement(z,{width:"100",height:"100"}):null,t>=2?a.a.createElement(G,{width:"80",height:"80",x:"10",y:"10"}):null,t>=3?a.a.createElement(U,{points:"20,62.4 20,37.55 37.534,20 62.4,20 80,37.55 80,62.4 62.4,80 37.55,80"}):null,n?a.a.createElement(D,{cx:"50",cy:"50",r:"25"}):null,r?a.a.createElement(J,{cx:"50",cy:"50",r:"20",player:r}):null))}}]),n}(r.Component);function N(){var e=Object(d.a)(["\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: space-between;\n  height: 540px;\n  margin-top: 10px;\n"]);return N=function(){return e},e}var V=v.a.div(N()),$=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,e)).onTileClick=function(e,t){r.setState((function(n){if(n.mode===w)return n.selectedTile===e?{selectedTile:null}:null===n.selectedTile?{selectedTile:e}:(M(n,e,r.props.game,t),{selectedTile:null});M(n,e,r.props.game,t)}))},r.setMode=function(e){e!==w?r.setState({mode:e,selectedTile:null}):r.setState({mode:e})},r.handleChange=function(e){var t=parseInt(e.target.value);r.setState({team:t})},r.state={mode:w,selectedTile:null,team:1},r}return Object(c.a)(n,[{key:"render",value:function(){var e=this,t=this.props.game,n=this.state,r=n.mode,l=n.team,o=n.selectedTile,i=Object.values(t.board).map((function(t,n){return a.a.createElement(K,{key:"tile"+n,level:t.level,roof:t.roof,player:t.player,onClick:function(){e.onTileClick(n,t)},selected:n===o})}));return a.a.createElement("div",null,a.a.createElement("label",null,"Team",a.a.createElement("select",{value:l,onChange:this.handleChange},a.a.createElement("option",{value:"1"},"Red"),a.a.createElement("option",{value:"2"},"Green"),a.a.createElement("option",{value:"3"},"Blue"),a.a.createElement("option",{value:"4"},"Purple"))),a.a.createElement("button",{onClick:function(){return e.setMode(w)},disabled:r===w},"Move worker"),a.a.createElement("button",{onClick:function(){return e.setMode(E)},disabled:r===E},"Add level"),a.a.createElement("button",{onClick:function(){return e.setMode(j)},disabled:r===j},"remove level"),a.a.createElement("button",{onClick:function(){return e.setMode(O)},disabled:r===O},"Add Worker"),a.a.createElement("button",{onClick:function(){return e.setMode(x)},disabled:r===x},"Remove worker"),a.a.createElement("button",{onClick:function(){return e.setMode(C)},disabled:r===C},"Add roof"),a.a.createElement("button",{onClick:function(){return e.setMode(T)},disabled:r===T},"Remove roof"),a.a.createElement(V,null,i))}}]),n}(r.Component);function F(){var e=Object(d.a)(["\n  width: 540px;\n  margin: 0 auto;\n"]);return F=function(){return e},e}var H=v.a.div(F());function Q(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;console.log("startnewgame",e,t),t||(t=p()());var n=window.location.origin+window.location.pathname+"?gameId="+t;e?window.location.href=n:window.history.replaceState(null,null,n)}var X=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(e){var r;Object(i.a)(this,n),console.log("constructor"),r=t.call(this,e);var a=new URL(window.location).searchParams.get("gameId");null===a&&Q(!1,a=p()());var l=a.replace(/[^\w\s]/gi,"");return a!==l&&Q(!1,l),g.gameId=a,console.log(g,a),r.state={loading:!0,gameId:a},r}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.updateListener=g.ref.on("value",(function(t){var n=t.val();if(null===n)try{e.state.gameId,g.ref.set({board:[{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0},{level:0,roof:!1,player:0}]}).catch((function(e){return console.error(e)}))}catch(r){e.setState({error:!0})}else e.setState({game:n,loading:!1})}))}},{key:"render",value:function(){var e=this.state,t=e.loading,n=e.error,r=e.game,l=e.gameId;return n?a.a.createElement("div",null,"An error occured, please refresh page to try again. If this persists, contact ",a.a.createElement("a",{href:"https://sebastiaanjansen.be/contact"},"Sebastiaan"),"."):t?a.a.createElement("div",null,"Loading...."):a.a.createElement(H,null,a.a.createElement($,{game:r,gameId:l}),a.a.createElement("button",{onClick:function(){Q(!0)}},"Start nieuw spel"))}}]),n}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(X,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[26,1,2]]]);
//# sourceMappingURL=main.441136f2.chunk.js.map